version: '3'

vars:
  # Externally passed configuration locations
  CONFIG_DIR: '{{.CONFIG_DIR | default "./config"}}'

  CONFIG_PYPROJECT: '{{.CONFIG_DIR}}/pyproject.toml'
  CONFIG_PROSPECTOR: '{{.CONFIG_DIR}}/.prospector.yml'

tasks:
  lint:
    - black --check --quiet --config={{.CONFIG_PYPROJECT}} .
    - isort --check --quiet --settings-file={{.CONFIG_PYPROJECT}} .
    - prospector --messages-only --profile={{.CONFIG_PROSPECTOR}}
    - pyright --project={{.CONFIG_PYPROJECT}} .

  format:
    - black --quiet --config={{.CONFIG_PYPROJECT}} .
    - isort --quiet --settings-file={{.CONFIG_PYPROJECT}} .
